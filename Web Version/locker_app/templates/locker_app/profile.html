{% extends 'locker_app/base.html' %}
{% load static %}

{% block title %}Profile - File Locker{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'locker_app/css/profile.css' %}">
{% endblock %}

{% block content %}
<div class="profile-container">
    <div class="glass-panel" style="padding: 2.5rem;">
        <div class="profile-header">
            <div class="profile-avatar">
                {{ user.username|first|upper }}
            </div>
            <div class="profile-info">
                <h2>{{ user.username }}</h2>
                <div class="profile-email">{{ user.email }}</div>
                <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">
                    <a href="{% url 'change_username' %}"
                        style="padding: 0.5rem 1rem; background: rgba(255, 255, 255, 0.1); color: white; text-decoration: none; border-radius: 0.5rem; font-size: 0.875rem; transition: background 0.2s;">Change
                        Username</a>
                    <a href="{% url 'change_password' %}"
                        style="padding: 0.5rem 1rem; background: rgba(255, 255, 255, 0.1); color: white; text-decoration: none; border-radius: 0.5rem; font-size: 0.875rem; transition: background 0.2s;">Change
                        Password</a>
                </div>
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-label">Member Since</span>
                <div class="stat-value">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    {{ user.date_joined|date:"F j, Y" }}
                </div>
            </div>
            <div class="stat-card">
                <span class="stat-label">Last Login</span>
                <div class="stat-value">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    {{ user.last_login|date:"F j, Y H:i" }}
                </div>
            </div>
        </div>

        <div class="dashboard-section">
            <div class="dashboard-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                </svg>
                Activity Dashboard
            </div>
            <p style="margin-bottom: 1rem; color: var(--text-muted);">Your recent file encryption and decryption
                activities.</p>

            {% if history %}
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="border-bottom: 2px solid var(--border-color);">
                            <th
                                style="text-align: left; padding: 0.75rem; color: var(--text-muted); font-weight: 600; font-size: 0.85rem;">
                                ACTION</th>
                            <th
                                style="text-align: left; padding: 0.75rem; color: var(--text-muted); font-weight: 600; font-size: 0.85rem;">
                                FILE(S)</th>
                            <th
                                style="text-align: left; padding: 0.75rem; color: var(--text-muted); font-weight: 600; font-size: 0.85rem; white-space: nowrap;">
                                DATE & TIME</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in history %}
                        <tr style="border-bottom: 1px solid var(--border-color);">
                            <td style="padding: 0.75rem;">
                                {% if item.action == 'encrypt' %}
                                <span
                                    style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.25rem 0.75rem; background: rgba(99, 102, 241, 0.1); color: #818cf8; border-radius: 1rem; font-size: 0.85rem; font-weight: 500;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                                        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                                    </svg>
                                    Encrypt
                                </span>
                                {% else %}
                                <span
                                    style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.25rem 0.75rem; background: rgba(16, 185, 129, 0.1); color: #34d399; border-radius: 1rem; font-size: 0.85rem; font-weight: 500;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                                        <path d="M7 11V7a5 5 0 0 1 9.9-1"></path>
                                    </svg>
                                    Decrypt
                                </span>
                                {% endif %}
                            </td>
                            <td style="padding: 0.75rem; color: var(--text-color); font-size: 0.9rem;">
                                {{ item.filename }}
                            </td>
                            <td
                                style="padding: 0.75rem; color: var(--text-muted); font-size: 0.85rem; white-space: nowrap;">
                                {{ item.timestamp|date:"M d, Y H:i" }}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div class="info-box">
                <div style="display: flex; gap: 0.75rem;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                    <div>
                        <strong>No activity yet.</strong> Start by encrypting or decrypting files on the <a
                            href="{% url 'home' %}"
                            style="color: var(--primary-color); text-decoration: none; font-weight: 500;">Home</a> page.
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}